{% extends "base.html" %}

{% block content %}

<h1>Manage Categories</h1>

    <h2>Add or Edit Category</h2>
    <form method="POST" action="{{ url_for('manage_categories') }}">
        <input type="hidden" name="id" id="id">
        <label for="name">Name:</label>
        <input type="text" name="name" id="name" required>
        
        <label for="level">Level:</label>
        <select name="level" id="level" required>
            <option value="1">Level 1</option>
            <option value="2">Level 2</option>
            <option value="3">Level 3</option>
        </select>
        
        <label for="parent">Parent Category (optional):</label>
        <select name="parent" id="parent">
            <option value="">-- No Parent --</option>
            {% for category in level_1_categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
            {% endfor %}
            {% for category in level_2_categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
            {% endfor %}
        </select>
        
        <button type="submit">Save</button>
    </form>

    <h2>Categories</h2>
    <h3>Level 1 Categories</h3>
    <ul>
        {% for category in level_1_categories %}
            <li>
                {{ category.name }}
                <button onclick="editCategory('{{ category.id }}', '{{ category.name }}', '{{ category.level }}', '{{ category.parent or '' }}')">Edit</button>
            </li>
        {% endfor %}
    </ul>

    <h3>Level 2 Categories</h3>
    <ul>
        {% for category in level_2_categories %}
            <li>
                {{ category.name }} (Parent: {{ category.parent.name if category.parent }})
                <button onclick="editCategory('{{ category.id }}', '{{ category.name }}', '{{ category.level }}', '{{ category.parent or '' }}')">Edit</button>
            </li>
        {% endfor %}
    </ul>

    <h3>Level 3 Categories</h3>
    <ul>
        {% for category in level_3_categories %}
            <li>
                {{ category.name }} (Parent: {{ category.parent.name if category.parent }})
                <button onclick="editCategory('{{ category.id }}', '{{ category.name }}', '{{ category.level }}', '{{ category.parent or '' }}')">Edit</button>
            </li>
        {% endfor %}
    </ul>

    <script>
        function editCategory(id, name, level, parent) {
            document.getElementById('id').value = id;
            document.getElementById('name').value = name;
            document.getElementById('level').value = level;
            document.getElementById('parent').value = parent;
        }
    </script>


{% endblock %}